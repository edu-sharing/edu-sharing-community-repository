<div class="close clickable" (click)="close()"><i class="material-icons">close</i></div>
<div class="valign-wrapper" *ngIf="loading">
  <spinner  class="loading"></spinner></div>
<div *ngIf="data">
  <div class="name">{{ data.name }}</div>

  <div class="row" *ngIf="!data.isDirectory">
      <div class="col s12">
        <ul class="tabs">
          <li class="clickable tab col s4" (click)="setTab(INFO)">
            <a [class.active]="tab==INFO" ><i class="material-icons">info_outline</i></a>
          </li>
          <li class="clickable tab col s4" (click)="setTab(PROPERTIES)">
            <a [class.active]="tab==PROPERTIES"><i class="material-icons">local_offer</i></a>
          </li>
          <li class="clickable tab col s4" (click)="setTab(VERSIONS)">
            <a [class.active]="tab==VERSIONS"><i class="material-icons">restore</i></a>
          </li>
        </ul>
    </div>
  </div>
  <div *ngIf="tab==INFO" class="content">
    <img class="preview clickable" (click)="display()" [src]="data.preview.includes('?') ? data.preview+'&crop=true&width=600&height=450' : data.preview" />
    <div class="edit clickable" (click)="edit()"><i class="material-icons">edit</i></div>
    <div class="description">{{'NODE.cm:name' | translate}}</div>
    <div class="value">{{data.name}}</div>
    <div class="description" *ngIf="data.title">{{'NODE.cclom:title' | translate}}</div>
    <div class="value" *ngIf="data.title">{{data.title}}</div>
    <div class="description" *ngIf="data.keywords">{{'NODE.cclom:general_keyword' | translate}}</div>
    <div class="value" *ngIf="data.keywords">
      <div class="badge" *ngFor="let keyword of data.keywords"><span class="text">{{ keyword }}</span></div>
    </div>
    <div class="description" *ngIf="data.description">{{'NODE.description' | translate}}</div>
    <div class="value descriptionValue" *ngIf="data.description">{{data.description}}</div>
    <div class="description" *ngIf="data.author_freetext">{{'NODE.ccm:author_freetext' | translate}}</div>
    <div class="value valueFreetext" *ngIf="data.author_freetext">{{data.author_freetext}}</div>
    <div class="description" *ngIf="data.author">{{'NODE.ccm:lifecyclecontributer_authorFN' | translate}}</div>
    <div class="value" *ngIf="data.author">{{data.author}}</div>
    <div class="description">{{'NODE.cm:creator' | translate}}</div>
    <div class="value">{{data.creator}}<br>{{data.createDate}}</div>
    <div class="description">{{'NODE.mimetype' | translate}}</div>
    <div class="value">
      <span *ngIf="data.mediatype && !data.isDirectory">{{'MEDIATYPE.'+data.mediatype | translate}}</span>
      <span *ngIf="!data.mediatype">{{'MEDIATYPE.file' | translate}}</span>
      <span *ngIf="data.isDirectory && !data.isCollection">{{'MEDIATYPE.folder' | translate}}</span>
      <span *ngIf="data.isCollection">{{'MEDIATYPE.collection' | translate}}</span>
      <span class="mimetype" *ngIf="data.mimetype && data.mediatype!=data.mimetype && !data.isDirectory">({{data.mimetype}})</span>
    </div>
    <div class="description" *ngIf="data.exifDate">{{'NODE.exif:dateTimeOriginal' | translate}}</div>
    <div class="value" *ngIf="data.exifDate">{{data.exifDate}}</div>
    <div class="description" *ngIf="data.dimensions">{{'NODE.dimensions' | translate}}</div>
    <div class="value" *ngIf="data.dimensions">{{data.dimensions}}</div>
    <div class="description" *ngIf="data.duration">{{'NODE.cclom:duration' | translate}}</div>
    <div class="value" *ngIf="data.duration">{{data.duration}}</div>
    <div class="description" *ngIf="!data.isDirectory">{{'NODE.size' | translate}}</div>
    <div class="value" *ngIf="!data.isDirectory && data.size">{{data.size | formatSize}}</div>
    <div class="value" *ngIf="!data.isDirectory && !data.size">{{'NO_SIZE' | translate}}</div>
    <div *ngIf="permissions">
      <div class="description" *ngIf="permissions.users.length">{{'WORKSPACE.METADATA.INVITED_USERS' | translate}}</div>
      <div class="value" *ngIf="permissions.users.length">
        <div *ngFor="let authority of permissions.users">{{authority | permissionName}}</div>
      </div>
      <div class="description" *ngIf="permissions.groups.length">{{'WORKSPACE.METADATA.INVITED_GROUPS' | translate}}</div>
      <div class="value" *ngIf="permissions.groups.length">
        <div *ngFor="let authority of permissions.groups">{{authority | permissionName}}</div>
      </div>

    </div>
    <div class="description" *ngIf="data.license">{{'NODE.ccm:commonlicense_key' | translate}}</div>
    <div class="value" *ngIf="data.license">
      <img class="license" [src]="data.license">
      <div class="licenseName">{{data.licenseName}}</div>
    </div>
    <div *ngIf="isAdmin">
      <div *ngFor="let property of data.properties">
        <div class="description">{{property[0]}}</div>
        <div class="value">{{property[1]}}</div>
      </div>
    </div>
  </div>
  <div *ngIf="tab==PROPERTIES" class="content">
    <div class="description"><a class="clickable" (click)="openPermalink()">{{'WORKSPACE.METADATA.PERMALINK' | translate}}</a></div>
    <div class="description">{{'WORKSPACE.METADATA.USAGE_COUNT' | translate}}</div>
    <div class="value">{{usageCount}}</div>
  </div>
  <div *ngIf="tab==VERSIONS" class="content">
    <div *ngIf="versionsLoading" class="center"><spinner></spinner></div>
    <div *ngFor="let version of versions" class="version" [class.versionMain]="isCurrentVersion(version)">
      <div class="versionTitle">
        <span *ngIf="isCurrentVersion(version)">{{'WORKSPACE.METADATA.CURRENT_VERSION' | translate}}</span>
        <span *ngIf="!isCurrentVersion(version)">{{'WORKSPACE.METADATA.VERSION' | translate}}</span>
        ({{ version.version.major }}.{{version.version.minor}})</div>
      <div class="versionAuthor">{{version.modifiedBy.firstName}} {{version.modifiedBy.lastName}}</div>
      <div class="versionDate">{{version.modifiedAt | formatDate}}</div>
      <div class="versionComment">{{version.comment && version.comment!="null" ? version.comment : ""}}</div>
      <div class="btn-flat btn-shadow btn-icon btnVersion" (click)="displayVersion(version)"><i class="material-icons">remove_red_eye</i> {{ 'WORKSPACE.METADATA.VIEW_VERSION' | translate}}</div>
      <div *ngIf="!isCurrentVersion(version)" class="btn-flat btn-shadow btn-icon-only" (click)="restoreVersion(version)"><i class="material-icons">restore</i></div>
    </div>
  </div>
</div>
